services:
  android:
    build:
      context: .
      args:
        - OPENJDK_VERSION=${OPENJDK_VERSION}
    ports:
      - "6080:6080" # noVNC web interface
      - "5901:5901" # VNC direct connection
      - "5555:5555" # ADB
      - "4723:4723" # Appium
    env_file:
      - .env
    volumes:
      - avd_data:/root/.android/avd
      - ./logs:/var/log/supervisor
      - sdk_data:/opt/android/sdk
    shm_size: '2gb' # Allocate more shared memory
    privileged: true # Enable KVM acceleration
    restart: "unless-stopped"

volumes:
  avd_data:
  sdk_data:
    external: true
